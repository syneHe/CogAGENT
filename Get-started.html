<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="author" content="SemiColonWeb" />

	<!-- Stylesheets
	============================================= -->
	<link href="https://fonts.googleapis.com/css?family=Noto+Sans:400,700|Noto+Serif:400,700&display=swap" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="css/bootstrap.css" type="text/css" />
	<link rel="stylesheet" href="style.css" type="text/css" />
	<link rel="stylesheet" href="css/dark.css" type="text/css" />

	<link rel="stylesheet" href="css/font-icons.css" type="text/css" />
	<link rel="stylesheet" href="css/animate.css" type="text/css" />
	<link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />

	<link rel="stylesheet" href="css/custom.css" type="text/css" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!--  Recipes Demo Specific Stylesheet -->
	<link rel="stylesheet" href="css/colors.php?color=267DF4" type="text/css" /> <!-- Theme Color -->
	<link rel="stylesheet" href="demos/recipes/css/fonts.css" type="text/css" /> <!-- Theme Font -->
	<link rel="stylesheet" href="demos/recipes/recipes.css" type="text/css" /> <!-- Theme Custom CSS -->

	<!-- Document Title
	============================================= -->
	<title>CogAgent - Get Started</title>

</head>

<body class="stretched">

	<!-- Document Wrapper
	============================================= -->
	<div id="wrapper" class="clearfix">

		<!-- Header
		============================================= -->
		<header id="header" class="transparent-header" data-sticky-shrink="false">
			<div id="header-wrap">
				<div class="container">
					<div class="header-row">

						<!-- Logo
						============================================= -->
						<div id="logo">
							<a href="home1.html" class="standard-logo"><img src="demos/cogagent/images/logo.png" alt="Cogagent Logo"></a>
							<a href="home1.html" class="retina-logo"><img src="demos/cogagent/images/logo@2x.png" alt="Cogagent Logo"></a>
						</div><!-- #logo end -->
						
						<div class="col-12 col-md-auto dark">

							<!-- Top Social
							============================================= -->
							<ul id="top-social">
								<li><a href="https://github.com/CogNLP/CogAGENT/" class="si-facebook" target="_blank"><span class="ts-icon"><i class="icon-github"></i></span>
								<li><a href="https://youtu.be/wYfYBbfQ00o" class="si-youtube" target="_blank"><span class="ts-icon"><i class="icon-youtube"></i></span>
							</ul><!-- #top-social end -->
	
						</div>
						<!-- <div class="header-misc">

							
							<div id="top-search" class="header-misc-icon">
								<a href="#" id="top-search-trigger"><i class="icon-line-search"></i><i class="icon-line-cross"></i></a>
							</div>

						</div> -->

						<div id="primary-menu-trigger">
							<svg class="svg-trigger" viewBox="0 0 100 100"><path d="m 30,33 h 40 c 3.722839,0 7.5,3.126468 7.5,8.578427 0,5.451959 -2.727029,8.421573 -7.5,8.421573 h -20"></path><path d="m 30,50 h 40"></path><path d="m 70,67 h -40 c 0,0 -7.5,-0.802118 -7.5,-8.365747 0,-7.563629 7.5,-8.634253 7.5,-8.634253 h 20"></path></svg>
						</div>

						<!-- Primary Navigation
						============================================= -->
						<nav class="primary-menu">

							<ul class="menu-container">
								<li class="menu-item current"><a class="menu-link" href="index.html"><div>Home</div></a></li>
								<!-- <li class="menu-item"><a class="menu-link" href="Paradigm.html"><div>Paradigm</div></a></li> -->
								<li class="menu-item"><a class="menu-link" href="Framework.html"><div>Framework</div></a></li>
								<li class="menu-item"><a class="menu-link" href="Get-started.html"><div>Get started</div></a></li>
								<li class="menu-item"><a class="menu-link" href="http://210.75.240.137:10000/"><div>Demos</div></a>
									<!-- <ul class="sub-menu-container rounded-bottom">
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Open domain question answering</div></a></li>
										 <div class="dropdown-divider my-0"></div>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Knowledge grounded dialogue</div></a></li>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Knowledge graph grounded dialogue</div></a></li>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Visual question answering</div></a></li>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Emoji visual answering</div></a></li>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Multimodal retrieval</div></a></li>
									</ul> -->
								</li>
								
								
							</ul>

						</nav><!-- #primary-menu end -->

						<!-- <form class="top-search-form" action="search.html" method="get">
							<input type="text" name="q" class="form-control" value="" placeholder="Type &amp; Hit Enter.." autocomplete="off">
						</form> -->
						
					</div>
				</div>
			</div>
			<div class="header-wrap-clone"></div>
		</header><!-- #header end -->

		<!-- Page Title
		============================================= -->

		<section id="page-title" class="page-title-parallax page-title-center page-title-dark include-header" style="background-image: linear-gradient(to top, rgba(248, 245, 242, 0.664), #39384D),  url('demos/seo/images/services/experience-title.jpg'); background-size: cover; padding: 120px 0;" data-bottom-top="background-position:0px 300px;" data-top-bottom="background-position:0px -300px;">
			<div id="particles-line"></div>

			<div class="container clearfix mt-4">
				<h1>Quick Start</h1>
			</div>

		</section><!-- #page-title end -->

		<!-- Content
		============================================= -->
		<section class="probootstrap-section">
			<div class="container mycontent">
				<br>
				<br>
				<!-- We show an concrete example of training an agent on the knowledge-grounded dialoguetask using dataset Wizards of Wikipedia. -->
				<br>
				<br>
				<h2>Training an agent on the knowledge-grounded dialogue task</h2>
				<h3>Import the modules </h3>
				<!-- <pre>from cogktr import *</pre> -->

				<!-- Load the raw dataset. -->
				<pre class="my_code" >
from cogagent import *
import torch
import torch.nn as nn
import torch.optim as optim
</pre>

<h3>Init the logger, device and experiment result saving dir</h3>
<pre class="my_code" >
device, output_path = init_cogagent(
	device_id=8,
	output_path=datapath,
	folder_tag="run_diffks_on_wow",
)

</pre>

<h3>Choose utterance reader</h3>
<pre class="my_code" >

reader = WoWReader(raw_data_path=raw_data_path)
train_data, dev_data, test_data = reader.read_all()
vocab = reader.read_vocab()
</pre>

<h3>Choose data processor </h3>
<pre class="my_code" >
 
# In the training phase, no retriever is selected as the knowledge is provided by dataset
processor = WoWForDiffksProcessor(max_token_len=512, vocab=vocab, debug=False)
train_dataset = processor.process_train(train_data)
dev_dataset = processor.process_dev(dev_data)
test_dataset = processor.process_test(test_data)
</pre>

<h3> Choose response generator</h3>
<pre class="my_code" >

 
model = DiffKSModel()
metric = BaseKGCMetric(default_metric_name="bleu-4",vocab=vocab)
loss = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.0001)
</pre>

<h3> Start Training</h3>
<pre class="my_code" >
# Use the provided Trainer class to start the model training process
trainer = Trainer(model,train_dataset,dev_data=test_dataset,n_epochs=40,batch_size=2,
					loss=loss,optimizer=optimizer,scheduler=None,metrics=metric,
					drop_last=False,gradient_accumulation_steps=1,num_workers=5,
					validate_steps=2000,save_by_metric="bleu-4",save_steps=None,
					output_path=output_path,grad_norm=1,
					use_tqdm=True,device=device,
					fp16_opt_level='O1',
					)
trainer.train()
					</pre>

 

			</div>
		</section><!-- #content end -->
		<footer id="footer" class="dark">

			<!-- Copyrights
			============================================= -->
			<div id="copyrights">
				<div class="container">

					<div class="row col-mb-30">

						<div class="row justify-content-between col-mb-30">
							<div class="col-12 col-lg-auto text-center text-lg-start">
								<div class="copyright-links"><p><a href="http://www.nlpr.ia.ac.cn/cip/english/introduction.htm" target="_blank">Chinese Information
									Processing Group</a>, <a href="http://www.nlpr.ia.ac.cn/en/" target="_blank">National Laboratory of
									Pattern Recognition</a>, <a href="http://english.ia.cas.cn" target="_blank">Casia, P.R.C</a></p></div>
							</div>
	
							<div class="col-12 col-lg-auto text-center text-lg-end">
								<div class="copyrights-menu copyright-links clearfix">
									<a href="index.html">Home</a>/<a href="Framework.html">Framework</a>/<a href="Get-started.html">Get Started</a>
								</div>
							</div>
						</div>

					</div>

				</div>
			</div><!-- #copyrights end -->

		</footer><!-- #footer end -->
					
			

			

		

	</div><!-- #wrapper end -->

	<!-- Go To Top
	============================================= -->
	<div id="gotoTop" class="icon-angle-up"></div>

	<!-- JavaScripts
	============================================= -->
	<script src="js/jquery.js"></script>
	<script src="js/plugins.min.js"></script>

	<!-- Footer Scripts
	============================================= -->
	<script src="js/functions.js"></script>

</body>
</html>