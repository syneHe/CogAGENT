<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="author" content="SemiColonWeb" />

	<!-- Stylesheets
	============================================= -->
	<link href="https://fonts.googleapis.com/css?family=Noto+Sans:400,700|Noto+Serif:400,700&display=swap" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="css/bootstrap.css" type="text/css" />
	<link rel="stylesheet" href="style.css" type="text/css" />
	<link rel="stylesheet" href="css/dark.css" type="text/css" />

	<link rel="stylesheet" href="css/font-icons.css" type="text/css" />
	<link rel="stylesheet" href="css/animate.css" type="text/css" />
	<link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />

	<link rel="stylesheet" href="css/custom.css" type="text/css" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!--  Recipes Demo Specific Stylesheet -->
	<link rel="stylesheet" href="css/colors.php?color=267DF4" type="text/css" /> <!-- Theme Color -->
	<link rel="stylesheet" href="demos/recipes/css/fonts.css" type="text/css" /> <!-- Theme Font -->
	<link rel="stylesheet" href="demos/recipes/recipes.css" type="text/css" /> <!-- Theme Custom CSS -->

	<!-- Document Title
	============================================= -->
	<title>CogAgent - Get Started</title>

</head>

<body class="stretched">

	<!-- Document Wrapper
	============================================= -->
	<div id="wrapper" class="clearfix">

		<!-- Header
		============================================= -->
		<header id="header" class="transparent-header" data-sticky-shrink="false">
			<div id="header-wrap">
				<div class="container">
					<div class="header-row">

						<!-- Logo
						============================================= -->
						<div id="logo">
							<a href="home1.html" class="standard-logo"><img src="demos/cogagent/images/logo.png" alt="Cogagent Logo"></a>
							<a href="home1.html" class="retina-logo"><img src="demos/cogagent/images/logo@2x.png" alt="Cogagent Logo"></a>
						</div><!-- #logo end -->
						
						<div class="col-12 col-md-auto dark">

							<!-- Top Social
							============================================= -->
							<ul id="top-social">
								<li><a href="https://github.com/CogNLP/CogKTR/" class="si-facebook" target="_blank"><span class="ts-icon"><i class="icon-github"></i></span>
								<li><a href="https://youtu.be/SrvXrXdDiVY" class="si-youtube" target="_blank"><span class="ts-icon"><i class="icon-youtube"></i></span>
							</ul><!-- #top-social end -->
	
						</div>
						<!-- <div class="header-misc">

							
							<div id="top-search" class="header-misc-icon">
								<a href="#" id="top-search-trigger"><i class="icon-line-search"></i><i class="icon-line-cross"></i></a>
							</div>

						</div> -->

						<div id="primary-menu-trigger">
							<svg class="svg-trigger" viewBox="0 0 100 100"><path d="m 30,33 h 40 c 3.722839,0 7.5,3.126468 7.5,8.578427 0,5.451959 -2.727029,8.421573 -7.5,8.421573 h -20"></path><path d="m 30,50 h 40"></path><path d="m 70,67 h -40 c 0,0 -7.5,-0.802118 -7.5,-8.365747 0,-7.563629 7.5,-8.634253 7.5,-8.634253 h 20"></path></svg>
						</div>

						<!-- Primary Navigation
						============================================= -->
						<nav class="primary-menu">

							<ul class="menu-container">
								<li class="menu-item current"><a class="menu-link" href="Home.html"><div>Home</div></a></li>
								<li class="menu-item"><a class="menu-link" href="Paradigm.html"><div>Paradigm</div></a></li>
								<li class="menu-item"><a class="menu-link" href="Framework.html"><div>Framework</div></a></li>
								<li class="menu-item"><a class="menu-link" href="https://18813157325-streamlit-app-test-co50q2.streamlit.app/"><div>Demos</div></a>
									<!-- <ul class="sub-menu-container rounded-bottom">
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Open domain question answering</div></a></li>
										 <div class="dropdown-divider my-0"></div>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Knowledge grounded dialogue</div></a></li>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Knowledge graph grounded dialogue</div></a></li>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Visual question answering</div></a></li>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Emoji visual answering</div></a></li>
										<li class="menu-item"><a class="menu-link" href="Home.html"><div>Multimodal retrieval</div></a></li>
									</ul> -->
								</li>
								
								
							</ul>

						</nav><!-- #primary-menu end -->

						<!-- <form class="top-search-form" action="search.html" method="get">
							<input type="text" name="q" class="form-control" value="" placeholder="Type &amp; Hit Enter.." autocomplete="off">
						</form> -->
						
					</div>
				</div>
			</div>
			<div class="header-wrap-clone"></div>
		</header><!-- #header end -->

		<!-- Page Title
		============================================= -->

		<section id="page-title" class="page-title-parallax page-title-center page-title-dark include-header" style="background-image: linear-gradient(to top, rgba(248, 245, 242, 0.664), #39384D),  url('demos/seo/images/services/experience-title.jpg'); background-size: cover; padding: 120px 0;" data-bottom-top="background-position:0px 300px;" data-top-bottom="background-position:0px -300px;">
			<div id="particles-line"></div>

			<div class="container clearfix mt-4">
				<h1>Quick Start</h1>
			</div>

		</section><!-- #page-title end -->

		<!-- Content
		============================================= -->
		<section class="probootstrap-section">
			<div class="container mycontent">
				<br>
				<br>
				We separate the source code to three main parts: enhancing the given texts with knowledge, constructing a knowledge-aware model and training the model.<br>
				We formalize a pipeline for these three steps so users can achieve our Unified Knowledge-Enhanced Paradigm easily.
				Before processing the input text, users should prepare the corresponding knowledge sources, which will be downloaded automatically.
				Then, the Reader, Enhancer and Processor class should be initialized to generate the knowledge-enhanced input of the models.
				Moreover, the T-Model, Metric, Loss and Optimizer class should be initialized before added to Trainer class. Users should initialize the K-Model class as the knowledge-enhanced encoder of the T-Model class.
				<br>
				<br>
				<h3>Enhancing the given texts with knowledge </h3>
				<pre>from cogktr import *</pre>

				Load the raw dataset.
				<pre class="my_code" >reader = Sst2Reader(raw_data_path="./datapath/text_classification/SST_2/raw_data")
train_data, dev_data, test_data = reader.read_all()
vocab = reader.read_vocab()</pre>

				Acquire and represent external knowledge.
				<pre class="my_code" >
enhancer = WorldEnhancer(knowledge_graph_path="./datapath/knowledge_graph",
                         cache_path="./datapath/text_classification/SST_2/enhanced_data",
                         cache_file="world_data",
                         reprocess=True,
                         load_entity_desc=True,
                         load_entity_embedding=False,
                         load_entity_kg=False)
enhanced_train_dict = enhancer.enhance_train(datable=train_data,
                                             enhanced_key_1="sentence",
                                             return_entity_desc=True)
enhanced_dev_dict = enhancer.enhance_dev(datable=dev_data,
                                         enhanced_key_1="sentence",
                                         return_entity_desc=True)
enhanced_test_dict = enhancer.enhance_test(datable=test_data,
                                           enhanced_key_1="sentence",
                                           return_entity_desc=True)</pre>

				Inject the knowledge into the model.
				<pre class="my_code" >processor = Sst2ForKtattProcessor(plm="bert-base-cased", max_token_len=128, vocab=vocab)
train_dataset = processor.process_train(data=train_data, enhanced_dict=enhanced_train_dict)
dev_dataset = processor.process_dev(data=dev_data, enhanced_dict=enhanced_dev_dict)
test_dataset = processor.process_test(data=test_data, enhanced_dict=enhanced_test_dict)</pre>

				<br>
				<h3>Construct the knowledge-aware model.</h3>
				<pre class="my_code" >
import torch
plm = PlmBertModel(pretrained_model_name="bert-base-cased")
model = BaseTextClassificationModel(plm=plm, vocab=vocab)
metrics = BaseClassificationMetric(mode="multi")
loss = torch.nn.CrossEntropyLoss()
optimizer = torch.optim.Adam(model.parameters(), lr=0.000001)
					</pre>

				<pre class="my_code" >
device, output_path = init_cogktr(
    device_id=0,
    output_path="./datapath/text_classification/SST_5/experimental_result",
    folder_tag="simple_test",
)
trainer = Trainer(model,
                  train_dataset,
                  dev_data=dev_dataset,
                  n_epochs=2000,
                  batch_size=100,
                  loss=loss,
                  optimizer=optimizer,
                  scheduler=None,
                  metrics=metric,
                  train_sampler=None,
                  dev_sampler=None,
                  drop_last=False,
                  gradient_accumulation_steps=1,
                  num_workers=5,
                  print_every=None,
                  scheduler_steps=None,
                  validate_steps=100,
                  save_steps=1000,
                  output_path=output_path,
                  grad_norm=1,
                  use_tqdm=True,
                  device=device,
                  callbacks=None,
                  metric_key=None,
                  fp16=False,
                  fp16_opt_level='O1',
                  )
					</pre>

				<br>
				<h3>Train the model </h3>
				<pre class="my_code" >trainer.train()</pre>


			</div>
		</section><!-- #content end -->
		<footer id="footer" class="dark">

			<!-- Copyrights
			============================================= -->
			<div id="copyrights">
				<div class="container">

					<div class="row col-mb-30">

						<div class="row justify-content-between col-mb-30">
							<div class="col-12 col-lg-auto text-center text-lg-start">
								<div class="copyright-links"><p><a href="http://www.nlpr.ia.ac.cn/cip/english/introduction.htm" target="_blank">Chinese Information
									Processing Group</a>, <a href="http://www.nlpr.ia.ac.cn/en/" target="_blank">National Laboratory of
									Pattern Recognition</a>, <a href="http://english.ia.cas.cn" target="_blank">Casia, P.R.C</a></p></div>
							</div>
	
							<div class="col-12 col-lg-auto text-center text-lg-end">
								<div class="copyrights-menu copyright-links clearfix">
									<a href="index.html">Home</a>/<a href="paradigm.html">Paradigm</a>/<a href="framework.html">Framework</a>
								</div>
							</div>
						</div>

					</div>

				</div>
			</div><!-- #copyrights end -->

		</footer><!-- #footer end -->
					
			

			

		

	</div><!-- #wrapper end -->

	<!-- Go To Top
	============================================= -->
	<div id="gotoTop" class="icon-angle-up"></div>

	<!-- JavaScripts
	============================================= -->
	<script src="js/jquery.js"></script>
	<script src="js/plugins.min.js"></script>

	<!-- Footer Scripts
	============================================= -->
	<script src="js/functions.js"></script>

</body>
</html>